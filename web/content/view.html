<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Vertical Editor</title>
</head>
<body>
    <div id="content"></div>
    <textarea id="input" cols="30" rows="10" oninput="input()"></textarea>
    <style>
        #input{
            width: calc(100% - 8px);
            margin-top: 1em;
            border-radius: 0;
            outline: none;
        }
        @import url('https://fonts.googleapis.com/css2?family=M+PLUS+1p:wght@500&display=swap');
        .row{
            display: flex;
            flex-direction: column;
        }
        .row span{
            font-family: 'M PLUS 1p', sans-serif;
            font-size: calc(clamp(100px, 50vh, 800px) / 20 * 0.6);
            width: calc(clamp(100px, 50vh, 800px) / 20);
            height: calc(clamp(100px, 50vh, 800px) / 20);
            display: inline-flex;
            justify-content: center;
            align-items: center;
            border: 1px rgb(180, 180, 180) solid;
            writing-mode: vertical-rl;
        }
        .row span:not(.row span:last-child){
            border-bottom: none;
        }
        .row:not(.row:last-child) span{
            border-left: none;
        }
        #content{
            display: flex;
            flex-direction: row-reverse;
            overflow-x: scroll;
        }
    </style>
    <script>
        const height = 20;
        const width = 20;

        function input(){
            draw(document.getElementById('input').value);
        }
        draw("");
        function draw(text){
            const content_old = document.getElementById("content");

            const content = content_old.cloneNode( false );
            content_old.parentNode.replaceChild( content , content_old );

            const rows = text
                .split(/\n/)
                .flatMap(v => {
                    if (v.length <= height) return [v];
                    const letters = v.split('');
                    let rows = [];
                    let lookingLetters = [];
                    letters.forEach(letter => {
                        lookingLetters.push(letter);
                        if(lookingLetters.length >= height) {
                            rows.push(lookingLetters);
                            lookingLetters = [];
                        }
                    });
                    rows.push(lookingLetters);
                    return rows.map(v => v.join(""));
                });
            rows.forEach(v => {
                const row = document.createElement("div");
                row.classList.add("row");

                const letters = v.split('');
                while (letters.length < height) letters.push('');
                letters.forEach(e => {
                    const spanElement = document.createElement("span");
                    spanElement.textContent = e;
                    row.appendChild(spanElement);
                });
                content.appendChild(row);
            });
        }
        
    </script>
</body>
</html>